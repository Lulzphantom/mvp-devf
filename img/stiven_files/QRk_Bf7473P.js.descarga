if (self.CavalryLogger) { CavalryLogger.start_js(["rQzzZ"]); }

__d("PhotoProgressBar.react",["ProgressBar.react","React","prop-types"],(function(a,b,c,d,e,f){__p&&__p();var g=1,h=50;a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={value:c.props.value},c.$3=function(){c.setState({value:c.state.value+g})},c.$1=function(a){var b=c.props,d=(b.max-b.min)*b.fakeLoadMultplier+b.min;a>=b.max&&a<d&&(window.clearTimeout(c.$2),c.$2=window.setTimeout(c.$3,h));return a/d*b.max},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.render=function(){var a=this.$1(this.state.value);return b("React").jsx(b("ProgressBar.react"),babelHelpers["extends"]({},this.props,{value:a}))};d.UNSAFE_componentWillReceiveProps=function(a){this.setState({value:a.value})};d.componentWillUnmount=function(){window.clearTimeout(this.$2)};return c}(b("React").Component);a.propTypes={fakeLoadMultplier:b("prop-types").number};a.defaultProps={fakeLoadMultplier:1.5,min:0,max:100};e.exports=a}),null);
__d("ProfilePicComposerStore",["FluxStore","ProfilePicComposerDispatcher","getByPath"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.__onDispatch=function(a){switch(a.type){case"set_composer_data":this.$ProfilePicComposerStore1=a.composerData;this.__emitChange();break}};d.getComposerData=function(){return this.$ProfilePicComposerStore1};d.getComposerID=function(){return b("getByPath")(this.$ProfilePicComposerStore1,["config","composerID"])};return c}(b("FluxStore"));a.__moduleID=e.id;e.exports=new a(b("ProfilePicComposerDispatcher"))}),null);
__d("ReactComposerProfilePicEagerAttachment.react",["cx","React","ReactComposerAttachmentBodyMixin","ReactComposerAttachmentType","ReactComposerConfig","ReactComposerContextConfig","ReactComposerContextTypes","ReactComposerStatusActions","ReactComposerStatusAttachmentMentionsInputWithTagExpansionContainer.react","createReactClass_DEPRECATED","prop-types"],(function(a,b,c,d,e,f,g){a=b("createReactClass_DEPRECATED")({displayName:"ReactComposerProfilePicEagerAttachment",contextTypes:b("ReactComposerContextTypes"),mixins:[b("ReactComposerAttachmentBodyMixin")()],propTypes:{config:b("ReactComposerConfig").isRequired,contextConfig:b("ReactComposerContextConfig").isRequired,mentionsSource:b("prop-types").object,placeholder:b("prop-types").string,selected:b("prop-types").bool},getInitialState:function(){return{focused:!1}},UNSAFE_componentWillMount:function(){b("ReactComposerStatusActions").setMentionsSource(this.context.composerID,this.props.mentionsSource)},statics:{attachmentID:b("ReactComposerAttachmentType").PROFILE_PIC_DESCRIPTION},renderX:function(){var a=this;return b("React").jsx("div",{className:"_2i1s"+(this.state.focused?" _3oxt":""),children:b("React").jsx(b("ReactComposerStatusAttachmentMentionsInputWithTagExpansionContainer.react"),{config:this.props.config,mentionsSource:this.props.mentionsSource,placeholder:this.props.placeholder,tabIndex:"0",onFocus:function(){return a.setState({focused:!0})},onBlur:function(){return a.setState({focused:!1})}})})}});e.exports=a}),null);
__d("ReactProfilePicComposer.react",["React","ReactComposer.react","ReactComposerBodyContainer.react","ReactComposerConfig","ReactComposerContextConfig","ReactComposerContextProviderMixin","ReactComposerProfilePicEagerAttachment.react","createReactClass_DEPRECATED","prop-types"],(function(a,b,c,d,e,f){a=b("createReactClass_DEPRECATED")({displayName:"ReactProfilePicComposer",mixins:[b("ReactComposerContextProviderMixin")],propTypes:{contextConfig:b("ReactComposerContextConfig").isRequired,config:b("ReactComposerConfig").isRequired,mentionsSource:b("prop-types").object.isRequired,placeholder:b("prop-types").string},render:function(){return b("React").jsx(b("ReactComposer.react"),{loggingConfig:this.props.config.loggingConfig,children:b("React").jsx(b("ReactComposerBodyContainer.react"),{children:b("React").jsx(b("ReactComposerProfilePicEagerAttachment.react"),babelHelpers["extends"]({},this.props,{selected:!0}))})})}});e.exports=a}),null);
__d("ProfilePicComposerContainer.react",["cx","CenteredContainer.react","FluxContainer","ProfilePicComposerStore","React","ReactProfilePicComposer.react","XUISpinner.react"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}c.getStores=function(){return[b("ProfilePicComposerStore")]};c.calculateState=function(a){return{composerData:b("ProfilePicComposerStore").getComposerData()}};var d=c.prototype;d.render=function(){return this.state.composerData?b("React").jsx(b("ReactProfilePicComposer.react"),babelHelpers["extends"]({},this.state.composerData,{placeholder:this.props.placeholder})):b("React").jsx(b("CenteredContainer.react"),{className:"_24io",vertical:!0,children:b("React").jsx(b("XUISpinner.react"),{})})};return c}(b("React").Component);e.exports=b("FluxContainer").create(a)}),null);
__d("XProfilePicComposerAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/profile/picture/composer_data/",{profile_id:{type:"FBID",required:!0}})}),null);
__d("ZoomProfilePicCropViewerBody.react",["cx","AsyncRequest","BasicVector","PhotoProgressBar.react","PhotoZoomCropDimensions","ProfilePhotoZoomCrop.react","ProfilePicComposerContainer.react","ProfilePicComposerDispatcher","ProfilePicComposerStore","ProfilePicCropViewerLoading.react","ProfilePicCropViewerStrings","ProfilePicOverlay.react","React","SpotlightViewerDimensionMixin","XProfilePicComposerAsyncController","createReactClass_DEPRECATED","prop-types"],(function(a,b,c,d,e,f,g){__p&&__p();var h=320;c=b("createReactClass_DEPRECATED")({displayName:"ZoomProfilePicCropViewerBody",_progress:null,mixins:[b("SpotlightViewerDimensionMixin")],propTypes:{height:(a=b("prop-types")).number.isRequired,onPhotoChange:a.func,photoData:a.object,photoDims:a.instanceOf(b("PhotoZoomCropDimensions")),photoID:a.string,profileID:a.string.isRequired,setid:a.string,showSpinner:a.bool.isRequired,source:a.string,uploadRequest:a.object,width:a.number.isRequired},getInitialState:function(){return{height:this.props.height,uploadStatus:null}},UNSAFE_componentWillMount:function(){b("ProfilePicComposerDispatcher").explicitlyRegisterStores([b("ProfilePicComposerStore")]);var a=b("XProfilePicComposerAsyncController").getURIBuilder().setFBID("profile_id",this.props.profileID).getURI();new(b("AsyncRequest"))(a).send()},componentDidMount:function(){this._listenForUploadProgress()},componentDidUpdate:function(){this._listenForUploadProgress()},componentWillUnmount:function(){this._progress&&(this._progress.unsubscribe(),this._progress=null)},render:function(){var a=this.props.photoData,c;this.state.uploadStatus!==null?c=b("React").jsx(b("PhotoProgressBar.react"),{className:"_2aii",isRounded:!0,size:"small",value:this.state.uploadStatus}):(!a||this.props.showSpinner)&&(c=b("React").jsx(b("ProfilePicCropViewerLoading.react"),{className:a?"":"_3mdt"}));return b("React").jsxs("div",{className:"_3mds","data-testid":"cropViewerBody",style:{height:this.state.height,width:this.props.width},children:[this._getImage(),c]})},_getImage:function(){__p&&__p();var a=this.props,c=a.photoData;a=a.photoDims;if(!c||!a)return null;if(c.previousprofilepic)return b("React").jsx(b("ProfilePhotoZoomCrop.react"),babelHelpers["extends"]({},this.props,{className:"_zxy _zy5",isPreviousProfilePic:!0,messageText:b("ProfilePicCropViewerStrings").THUMBNAIL_MODE_EXPLANATION,ref:"image",src:c.original.uri}));a=new(b("BasicVector"))(c.original.width,c.original.height);a=a.x<h||a.y<h?b("ProfilePicCropViewerStrings").SMALL_PHOTO_WARNING:b("ProfilePicCropViewerStrings").ZOOM_WARNING;var d=null;c.overlayData&&(d=b("React").jsx(b("ProfilePicOverlay.react"),{src:c.overlayData.src}));d=b("React").jsx(b("ProfilePhotoZoomCrop.react"),babelHelpers["extends"]({},this.props,{overlay:d,ref:"image",src:c.original.uri,warningText:a}));if(this.props.source!=="family_member"){this.state.height&&this.setState({height:null});return b("React").jsxs("div",{children:[b("React").jsx(b("ProfilePicComposerContainer.react"),{placeholder:b("ProfilePicCropViewerStrings").CAPTION_INPUT_PLACEHOLDER}),d]})}return d},resetDimensions:function(){this.refs.image.resetDimensions()},getDimensionsArea:function(){return this.refs.image.getDimensions().getArea()},hasSpaceToDrag:function(){if(!this.props.photoData)return!1;var a=new(b("BasicVector"))(this.props.photoData.original.width,this.props.photoData.original.height);return!b("PhotoZoomCropDimensions").isSquare(a)},_listenForUploadProgress:function(){var a=this,b=this.props.uploadRequest;b&&b.subscribe&&!this._progress&&(this._progress=b.subscribe("progress",function(b,c){return a.setState({uploadStatus:c.event.loaded/c.event.total*100})}))}});e.exports=c}),null);
__d("ZoomProfilePicCropViewerFooterButtons.react",["ProfilePicCropViewerStrings","ProfilePicViewerFooterText.react","React","XUIButton.react","prop-types"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){if(this.props.savingMode)return b("React").jsx(b("ProfilePicViewerFooterText.react"),{weight:"bold",children:b("ProfilePicCropViewerStrings").CROP_SAVING});if(this.props.uploadRequest)return b("React").jsx(b("XUIButton.react"),{label:b("ProfilePicCropViewerStrings").BUTTON_CANCEL,onClick:this.props.onUploadCancel});return this.props.hasPhoto?b("React").jsxs("div",{children:[this.props.privacyIcon,b("React").jsx(b("XUIButton.react"),{disabled:!1,label:b("ProfilePicCropViewerStrings").BUTTON_CANCEL,onClick:this.props.onCancel}),b("React").jsx(b("XUIButton.react"),{"data-testid":"profilePicSaveButton",disabled:!1,label:this.props.saveButtonLabel,onClick:this.props.onSaveClick,use:"confirm"})]}):b("React").jsx(b("ProfilePicViewerFooterText.react"),{children:"\xa0"})};return c}(b("React").PureComponent);a.propTypes={hasPhoto:(c=b("prop-types")).bool,onCancel:c.func,onSaveClick:c.func,onUploadCancel:c.func,privacyIcon:c.element,saveButtonLabel:c.oneOfType([c.string,c.object]),savingMode:c.bool,source:c.string,uploadRequest:c.object};e.exports=a}),null);
__d("ZoomProfilePicCropViewerFooterLeftContent.react",["ix","cx","FlexLayout.react","Image.react","Link.react","ProfilePicCropViewerStrings","ProfilePicViewerFooterText.react","React","XUIButton.react","ZoomProfilePicCropModes","fbglyph","prop-types"],(function(a,b,c,d,e,f,g,h){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){__p&&__p();var a=this.props.photoData;if(!a||this.props.uploadRequest||this.props.cropMode===b("ZoomProfilePicCropModes").CROP_ONLY)return b("React").jsx(b("ProfilePicViewerFooterText.react"),{children:"\xa0"});if(a.previousprofilepic)return b("React").jsx(b("ProfilePicViewerFooterText.react"),{children:b("ProfilePicCropViewerStrings").PREV_PHOTO_ADJUST_THUMBNAIL});if(this.props.isSaving||a.stickerData)return b("React").jsx(b("ProfilePicViewerFooterText.react"),{children:"\xa0"});var c,d,e=this.props.cropMode===b("ZoomProfilePicCropModes").FRAME;e?(c=b("ProfilePicCropViewerStrings").CROP_AND_SAVE,d=b("ProfilePicCropViewerStrings").FRAME_PREVENTS_CROP):this.props.cropMode===b("ZoomProfilePicCropModes").CROP?(c=b("ProfilePicCropViewerStrings").SKIP_CROP,d=b("ProfilePicCropViewerStrings").SKIP_CROP_EXPLANATION):(c=b("ProfilePicCropViewerStrings").CROP_AND_SAVE,d=b("ProfilePicCropViewerStrings").CROP_EXPLANATION);var f=this.props.onModeChange,h=null;a.hasExistingProfilePic&&this.props.source!=="legacy_contact"&&(h=b("React").jsx(b("XUIButton.react"),{className:"_4vsj _3-8j _3-99",depressed:this.props.makeTemporaryButtonDepressed,image:b("React").jsx(b("Image.react"),{src:g("141869")}),label:b("ProfilePicCropViewerStrings").BUTTON_MAKE_TEMPORARY,onClick:this.props.onExpiringControlClick}));return b("React").jsxs(b("FlexLayout.react"),{className:"_4vsi _3-8_ _2pis",children:[h,b("React").jsx("div",{className:"_3-99 _2pi4",children:b("React").jsx(b("ProfilePicViewerFooterText.react"),{children:b("React").jsx(b("Link.react"),{"aria-label":d,className:"_4vsh"+(e?" _5vll":""),"data-hover":"tooltip",onClick:function(){return!e&&f&&f()},children:c})})})]})};return c}(b("React").PureComponent);a.propTypes={cropMode:(c=b("prop-types")).oneOf(Object.keys(b("ZoomProfilePicCropModes"))),isSaving:c.bool,makeTemporaryButtonDepressed:c.bool,onExpiringControlClick:c.func,onModeChange:c.func,photoData:c.object,source:c.string,uploadRequest:c.object};e.exports=a}),null);
__d("ZoomProfilePicCropViewer.react",["cx","fbt","ix","ArbiterMixin","DateConsts","PhotoZoomCropDimensions","ProfileMediaAlwaysPublicIcon.react","ProfilePicComposerStore","ProfilePicCropViewerMixin","ProfilePicCropViewerStrings","ProfilePicExpirationSelector.react","ProfilePictureFlowLogging","React","ReactComposerStatusStore","SpotlightViewerCoreMixin","SpotlightViewerDimensionMixin","XUIDialog.react","XUIDialogTitle.react","XUIGrayText.react","ZoomProfilePicCropModes","ZoomProfilePicCropViewerBody.react","ZoomProfilePicCropViewerFooter.react","ZoomProfilePicCropViewerFooterButtons.react","ZoomProfilePicCropViewerFooterLeftContent.react","createReactClass_DEPRECATED","prop-types"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=484,k=775;c=b("createReactClass_DEPRECATED")({displayName:"ZoomProfilePicCropViewer",__shouldPreventPhotoPreload:!0,_hasFrame:!1,mixins:[b("ArbiterMixin"),b("ProfilePicCropViewerMixin"),b("SpotlightViewerCoreMixin"),b("SpotlightViewerDimensionMixin")],propTypes:{cancelCallback:(a=b("prop-types")).func,cropControllerURIBuilder:a.object,cropMode:a.oneOf(Object.keys(b("ZoomProfilePicCropModes"))),errorCallback:a.func,photoID:a.string,profileID:a.string.isRequired,setid:a.string.isRequired,source:a.string,successCallback:a.func,uploadRequest:a.object,warnOnCancel:a.bool},getInitialState:function(){return{expirationTime:null,frameData:null,cropMode:this.props.cropMode||b("ZoomProfilePicCropModes").CROP,open:!0,photoData:null,photoDims:null,savingMode:!1,showExpirationControls:!1,showLoading:!1,zoomSliderPosition:null}},componentDidMount:function(){var a=this;this.subscribe("photo_change",function(){var c=null;a._hasFrame&&(c={center:{x:.5,y:.5},size:{x:1,y:1}});c=b("PhotoZoomCropDimensions").fromProfilePhotoData(a.state.photoData,c);a.setState({photoDims:c,showLoading:!1,zoomSliderPosition:c.getZoom()})})},render:function(){var a=this,c=null;this.state.showExpirationControls&&(c=b("React").jsx("div",{className:"_1zst",children:b("React").jsx(b("ProfilePicExpirationSelector.react"),{defaultValue:this.state.expirationTime,onChange:function(b){return a.setState({expirationTime:b})},showCustomOption:!0})}));var d=this.state,e=d.photoData;d=d.photoDims;var f;this.props.source==="family_member"?f=b("React").jsx(b("ProfileMediaAlwaysPublicIcon.react"),{privacyMessage:h._("Esta foto la ver\u00e1n todas las personas que puedan ver al menos una foto de este \u00e1lbum de recuerdos."),sourceImage:i("83912")}):e&&!e.isWorkUser?f=b("React").jsx(b("ProfileMediaAlwaysPublicIcon.react"),{}):f=null;return b("React").jsxs(b("XUIDialog.react"),{"data-testid":"profile_pic_crop_dialog",layerHideOnBlur:!1,modal:!0,shown:!0,width:k,children:[b("React").jsx(b("XUIDialogTitle.react"),{showCloseButton:!0,children:b("React").jsx(b("XUIGrayText.react"),{display:"block",shade:"medium",size:"header4",weight:"bold",children:this._getTitle()})}),b("React").jsx(b("ZoomProfilePicCropViewerBody.react"),{height:j,messageText:this.state.cropMode===b("ZoomProfilePicCropModes").SET_THUMBNAIL?b("ProfilePicCropViewerStrings").THUMBNAIL_MODE_EXPLANATION:null,onMove:this._handleMove,onPhotoChange:this._handlePhotoChange,photoData:e,photoDims:d,photoID:this.props.photoID,profileID:this.props.profileID,ref:"zoomBody",setid:this.props.setid,showSpinner:this.state.savingMode||this.state.showLoading,source:this.props.source,uploadRequest:this.props.uploadRequest,width:k}),c,b("React").jsxs(b("ZoomProfilePicCropViewerFooter.react"),{hideZoomSlider:this.state.cropMode===b("ZoomProfilePicCropModes").FRAME||this.state.savingMode,onZoom:this._handleZoom,photoDims:d,zoomSliderPosition:this.state.zoomSliderPosition,children:[b("React").jsx(b("ZoomProfilePicCropViewerFooterLeftContent.react"),{cropMode:this.state.cropMode,isSaving:this.state.savingMode,makeTemporaryButtonDepressed:this.state.showExpirationControls,onExpiringControlClick:this.handleExpiringControlClick,onModeChange:this.handleModeChange,photoData:e,source:this.props.source,uploadRequest:this.props.uploadRequest}),b("React").jsx(b("ZoomProfilePicCropViewerFooterButtons.react"),{hasPhoto:!!e,onCancel:this.handleCancel,onSaveClick:this.handleSaveClick,onUploadCancel:this.handleUploadCancel,privacyIcon:f,saveButtonLabel:this._getSaveButtonLabel(),savingMode:this.state.savingMode,uploadRequest:this.props.uploadRequest})]})]})},_getTitle:function(){var a=this.state.photoData;if(this.props.uploadRequest)return b("ProfilePicCropViewerStrings").UPLOADING;else if(!a)return b("ProfilePicCropViewerStrings").LOADING;else if(a.previousprofilepic)return b("ProfilePicCropViewerStrings").SET_THUMBNAIL;return b("ProfilePicCropViewerStrings").UMG_TITLE},_handlePhotoChange:function(a){this.setState({showLoading:!0}),a&&(this.viewState.forward(),this.setState({frameData:a.frameData}),this._hasFrame=!!a.frameData,this._hasFrame&&this.setState({cropMode:b("ZoomProfilePicCropModes").FRAME}))},_handleZoom:function(a,b){a=this.state.photoDims.cloneAndZoom(a[0]);this.setState({photoDims:a,zoomSliderPosition:b||a.getZoom()})},handleModeChange:function(){var a=this._isCropMode()?b("ZoomProfilePicCropModes").SET_THUMBNAIL:b("ZoomProfilePicCropModes").CROP;this.setState({cropMode:a})},handleSaveClick:function(){__p&&__p();if(this.state.cropMode===b("ZoomProfilePicCropModes").FRAME){this.handleCropSave();return}if(this.state.photoData&&this.state.photoData.previousprofilepic){this.handlePositionSave();return}if(this._isCropMode()){this.handleCropSave();return}this.handleSetThumbnailSave()},handleExpiringControlClick:function(){var a=!this.state.showExpirationControls,c=null;a&&(c=b("DateConsts").SEC_PER_DAY);this.setState({showExpirationControls:a,expirationTime:c})},_handleMove:function(a,b){this.setState({photoDims:this.state.photoDims.cloneAndMove(a,b)})},_getSaveButtonLabel:function(){return b("ProfilePicCropViewerStrings").BUTTON_SAVE},_isCropMode:function(){return this.state.cropMode===b("ZoomProfilePicCropModes").CROP},getCropArea:function(){return this.state.photoDims.getArea()},getFlowType:function(){return b("ProfilePictureFlowLogging").flow.ZOOMCROP},getPhotoSize:function(){return this.state.photoData.original},getCaption:function(){var a=b("ProfilePicComposerStore").getComposerID();return a?b("ReactComposerStatusStore").getMessage(a):""},getOverlayData:function(){return this.state.frameData},getOverlaySourceObjectID:function(){return null},getPaymentID:function(){return null},getViewerID:function(){return this.props.setid}});e.exports=c}),null);