if (self.CavalryLogger) { CavalryLogger.start_js(["PFmnx"]); }

__d("AbstractRangeInput.react",["cx","Event","Keys","React","ReactDOM","UserAgent","joinClasses","prop-types"],(function(a,b,c,d,e,f,g){__p&&__p();var h={BLOCK:"block",PUSH:"push",FREE:"free"};a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){__p&&__p();var d;d=a.call(this,c)||this;d.$7=function(a,c){switch(b("Event").getKeyCode(c)){case b("Keys").DOWN:case b("Keys").LEFT:d.$8(a);d.$9(-1);break;case b("Keys").RIGHT:case b("Keys").UP:d.$8(a);d.$9(1);break}};d.$10=function(a,c){b("Event").prevent(c),d.$8(a),d.$2.dragStartX=c.nativeEvent.clientX};d.$3=function(a){d.$2&&d.$9(a.clientX-d.$2.dragStartX)};d.$8=function(a){d.$2={draggingIdx:a,dragStartValue:d.state.values[a],scale:b("ReactDOM").findDOMNode(babelHelpers.assertThisInitialized(d)).clientWidth}};d.$9=function(a){__p&&__p();var b=(d.props.max-d.props.min)/d.$2.scale;a=d.$2.dragStartValue+a*b;b=[].concat(d.state.values);var c=b.length,e=d.$2.draggingIdx;if(d.props.step){var f=1/d.props.step;a=Math.round(a*f)/f}f=d.props.min;var g=d.props.max;d.props.behavior===h.BLOCK&&(f=e>0?b[e-1]:f,g=e<c-1?b[e+1]:g);a=a<f?f:a;a=a>g?g:a;b[e]=a;if(d.props.behavior===h.PUSH){for(var c=e+1,f=b.length;c<f;c++){if(b[c]>=a)break;b[c]=a}for(c=e-1;c>=0;c--){if(b[c]<=a)break;b[c]=a}}d.setState({values:b});d.props.onChange&&d.props.onChange(b)};d.$4=function(a){d.$2&&(d.$2=null)};d.$6=function(a){d.$2&&(d.$2=null)};d.$5=function(a){d.$2&&a.touches&&d.$9(a.touches[0].clientX-d.$2.dragStartX)};var e=c.values;c.behavior!==h.FREE&&e.sort();d.state={values:e};return d}c.getDerivedStateFromProps=function(a,b){return{values:a.values}};var d=c.prototype;d.componentDidMount=function(){var a=this,c=b("UserAgent").isBrowser("IE < 9")?document.documentElement:window;this.$1=b("Event").listen(c,{selectstart:function(c){a.$2&&b("Event").prevent(c)},mousemove:this.$3,mouseup:this.$4,touchmove:this.$5,touchend:this.$6})};d.componentWillUnmount=function(){for(var a in this.$1)this.$1[a]&&this.$1[a].remove(),this.$1[a]=null};d.$11=function(a,c){b("Event").prevent(c),this.$8(a),this.$2.dragStartX=c.nativeEvent.touches[0].clientX};d.render=function(){__p&&__p();var a=this,c=this.state.values,d=this.props.disabled,e=c.length>1,f=this.props.max-this.props.min;c=c.map(function(c,g){var h=(c-a.props.min)/f,i=a.props.name+(e?"["+g+"]":"");return b("React").jsx("div",{className:"_4qwr"+(d?" _4qws":""),onDragStart:b("Event").prevent,onKeyDown:d?null:function(b){return a.$7(g,b)},onMouseDown:d?null:function(b){return a.$10(g,b)},onTouchEnd:d?null:function(b){return a.$6(g,b)},onTouchMove:d?null:function(b){return a.$5(g,b)},onTouchStart:d?null:function(b){return a.$11(g,b)},style:{left:h*100+"%"},tabIndex:0,children:b("React").jsx("input",{onChange:a.props.onChange,name:i,value:c,type:"hidden"})},"thumb-"+g)});return b("React").jsxs("div",babelHelpers["extends"]({},this.props,{className:b("joinClasses")(this.props.className,"_4qwt"),children:[b("React").jsx("div",{className:"_4qwu"}),c]}))};return c}(b("React").Component);a.propTypes={name:(c=b("prop-types")).string,min:c.number,max:c.number,step:c.number,disabled:c.bool,values:c.array,behavior:c.oneOf([h.BLOCK,h.PUSH,h.FREE]),onChange:c.func};a.defaultProps={name:"",min:0,max:1,step:.01,disabled:!1,values:[.5],behavior:h.FREE};e.exports=a}),null);
__d("XPhotoCropSaverAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/photo/crop/upload/",{photo_id:{type:"Int",required:!0},height:{type:"Float",required:!0},width:{type:"Float",required:!0},x:{type:"Float",required:!0},y:{type:"Float",required:!0},source:{type:"Enum",enumType:0}})}),null);
__d("PhotoCropperSaver",["ActorURI","ArbiterMixin","AsyncRequest","XPhotoCropSaverAsyncController","mixin"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b){var c;c=a.call(this)||this;c.$PhotoCropperSaver1=b;return c}var d=c.prototype;d.saveCroppedPhoto=function(a,c){a=b("XPhotoCropSaverAsyncController").getURIBuilder().setFloat("x",a.x).setFloat("y",a.y).setFloat("width",Math.min(a.width,1)).setFloat("height",Math.min(a.height,1)).setInt("photo_id",this.$PhotoCropperSaver1).getURI();c&&(a=b("ActorURI").create(a,c));new(b("AsyncRequest"))(a).setErrorHandler(this.$PhotoCropperSaver2.bind(this)).setHandler(this.$PhotoCropperSaver3.bind(this)).send()};d.$PhotoCropperSaver2=function(a){this.inform("error",a)};d.$PhotoCropperSaver3=function(a){this.inform("success",a)};return c}(b("mixin")(b("ArbiterMixin")));e.exports=a}),null);
__d("PhotoCropperViewerStrings",["fbt"],(function(a,b,c,d,e,f,g){a={REPOSITION_CURRENT_TITLE:g._("Recortar foto"),LOADING_LABEL:g._("Cargando..."),SAVING_LABEL:g._("Guardando..."),SAVING_TITLE:g._("Guardando\u2026"),LOADING:g._("Cargando..."),BUTTON_SAVE:g._("Guardar"),BUTTON_CANCEL:g._("Cancelar")};e.exports=a}),null);
__d("ProfilePicCropViewerStrings",["fbt"],(function(a,b,c,d,e,f,g){a={BUTTON_CANCEL:g._("Cancelar"),BUTTON_CLOSE:g._("Cerrar"),BUTTON_EDIT:g._("Editar"),BUTTON_MAKE_TEMPORARY:g._("Usar temporalmente"),BUTTON_SAVE:g._("Guardar"),CAPTION_INPUT_PLACEHOLDER:g._("Agrega una descripci\u00f3n..."),CROP_AND_SAVE:g._("Recortar foto"),CROP_EXPLANATION:g._("Recorta esta foto antes de guardarla como foto del perfil."),CROP_INSTRUCTIONS:g._("Mueve el cuadro hasta el lugar donde quieres recortar la foto. Arrastra las esquinas hacia adentro o hacia afuera para ajustar el tama\u00f1o."),CROP_SAVING:g._("Guardando foto del perfil..."),DIALOG_TITLE:g._("Cambiar a la foto del perfil anterior en"),LEAVE_WARNING_BODY:g._("Los cambios que hiciste tu foto del perfil no se guardar\u00e1n si cierras este cuadro de di\u00e1logo."),LEAVE_WARNING_CANCEL:g._("No salir de esta p\u00e1gina"),LEAVE_WARNING_OK:g._("Salir de esta p\u00e1gina"),LEAVE_WARNING_TITLE:g._("Los cambios no se guardaron"),LEAVE_WARNING_UNLOAD:g._("Los cambios que hiciste en tu foto del perfil no se guardaron."),LOADING:g._("Cargando..."),PREV_PHOTO_ADJUST_THUMBNAIL:g._("Ya usaste esta foto como foto del perfil."),FRAME_PREVENTS_CROP:g._("No puedes recortar la foto despu\u00e9s de agregarle un marco."),PREVIOUS_PIC:g._("Ya usaste esta foto como foto del perfil. \u00bfQuieres usarla de nuevo?"),PROFILE_PIC_VISIBILITY:g._("La foto del perfil siempre es p\u00fablica."),TEMPORARY_PROFILE_PIC_CONTROL:g._("Cambiar a la foto del perfil anterior en"),TEMPORARY_OPTION_ONE_HOUR:g._("1 hora"),TEMPORARY_OPTION_ONE_DAY:g._("1 d\u00eda"),TEMPORARY_OPTION_ONE_WEEK:g._("1 semana"),TEMPORARY_OPTION_NEVER:g._("Nunca"),TEMPORARY_OPTION_CUSTOM:g._("Personalizado"),HIDDEN_FROM_NEWS_FEED:g._("Los cambios no aparecer\u00e1n en la secci\u00f3n de noticias."),SAVE_AND_CROP:g._("Recortar y guardar"),SAVED_BODY:g._("Se guard\u00f3 correctamente tu foto del perfil."),SAVED_TITLE:g._("Foto del perfil guardada"),SET_THUMBNAIL:g._("Elegir imagen en miniatura"),SKIP_CROP:g._("No recortar"),SKIP_CROP_EXPLANATION:g._("Guarda toda la foto como foto del perfil y elige la imagen en miniatura."),THUMBNAIL_MODE_EXPLANATION:g._("Se guardar\u00e1 toda la foto como foto del perfil. Mu\u00e9vela para elegir la imagen en miniatura."),UMG_TITLE:g._("Crear foto del perfil"),UPLOADING:g._("Subiendo..."),USE_AS_PROFILE_PICTURE:g._("Usar como foto del perfil"),SMALL_PHOTO_WARNING:g._("Esta foto es peque\u00f1a, y tu foto del perfil se ver\u00e1 con menos claridad."),ZOOM_WARNING:g._("Tu foto del perfil no se ver\u00e1 n\u00edtida si la ampl\u00edas tanto.")};e.exports=a}),null);
__d("ProfileMediaAlwaysPublicIcon.react",["ix","cx","Image.react","ProfilePicCropViewerStrings","React","Tooltip","fbglyph","joinClasses","prop-types"],(function(a,b,c,d,e,f,g,h){__p&&__p();a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").jsx(b("Image.react"),babelHelpers["extends"]({className:b("joinClasses")(this.props.className,"_1wlw")},b("Tooltip").propsFor(this.props.privacyMessage),{src:this.props.sourceImage}))};return c}(b("React").PureComponent);a.propTypes={privacyMessage:b("prop-types").string.isRequired,sourceImage:b("prop-types").object};a.defaultProps={privacyMessage:b("ProfilePicCropViewerStrings").PROFILE_PIC_VISIBILITY,sourceImage:g("124640")};e.exports=a}),null);
__d("ProfilePicCropViewerLoading.react",["cx","React","XUISpinner.react","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").jsx("div",{className:b("joinClasses")("_278e",this.props.className),children:b("React").jsx(b("XUISpinner.react"),{background:"dark",className:"_4-cf",size:"large"})})};return c}(b("React").Component);e.exports=a}),null);
__d("ProfilePicViewerFooterText.react",["cx","React","XUIGrayText.react"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").jsx(b("XUIGrayText.react"),babelHelpers["extends"]({},this.props,{className:"_2pi2",display:"block",shade:"medium",size:"meta1",children:this.props.children}))};return c}(b("React").Component);e.exports=a}),null);
__d("PhotoZoomCropStrings",["fbt"],(function(a,b,c,d,e,f,g){a={BUTTON_ZOOM_IN:g._("Ampliar imagen"),BUTTON_ZOOM_OUT:g._("Reducir imagen")};e.exports=a}),null);
__d("PhotoZoomCropSlider.react",["cx","AbstractRangeInput.react","PhotoZoomCropStrings","React","clamp","createReactClass_DEPRECATED","joinClasses","prop-types"],(function(a,b,c,d,e,f,g){__p&&__p();var h=6;c=b("createReactClass_DEPRECATED")({displayName:"PhotoZoomCropSlider",propTypes:{onZoom:(a=b("prop-types")).func.isRequired,position:a.number,zoom:a.number,zoomRange:a.object.isRequired},render:function(){var a=this.props.zoomRange,c=a.max===this.props.zoom,d=a.min===this.props.zoom;return b("React").jsxs("div",{className:b("joinClasses")(this.props.className,"_55vh"),children:[b("React").jsx("button",{className:(d?"_4nc5":"")+" _4nc6",onClick:this._minus,tabIndex:d?-1:0,title:b("PhotoZoomCropStrings").BUTTON_ZOOM_OUT}),b("React").jsx(b("AbstractRangeInput.react"),{className:"_55vj",disabled:a.max===a.min,max:a.max,min:a.min,onChange:this._logarithmicZoom,values:[this.props.position]}),b("React").jsx("button",{className:(c?"_4nc5":"")+" _4nc7",onClick:this._plus,tabIndex:c?-1:0,title:b("PhotoZoomCropStrings").BUTTON_ZOOM_IN})]})},_logarithmicZoom:function(a){__p&&__p();var c=this.props.zoomRange,d=c.max;c=c.min;var e=Math.log2(d),f=Math.log2(c);a=a[0];e=(e-f)/d;var g=Math.exp(f+e*d),h=Math.exp(f+e*c);f=Math.exp(f+e*a);e=b("clamp")((f-h)/(g-h),0,100);f=c+e*(d-c);this.props.onZoom([f],a)},_zoomInDirection:function(a){var c=this.props.zoomRange,d=c.max;c=c.min;this.props.onZoom([b("clamp")(this.props.zoom+a*(d-c)/h,c,d)])},_minus:function(){this._zoomInDirection(-1)},_plus:function(){this._zoomInDirection(1)}});e.exports=c}),null);
__d("PhotoZoomCrop.react",["cx","BasicVector","PhotoZoomCropDimensions","PhotoZoomCropImage.react","PhotoZoomCropImagePreview.react","PhotoZoomCropMixin","PhotoZoomCropSlider.react","React","createReactClass_DEPRECATED","joinClasses","prop-types"],(function(a,b,c,d,e,f,g){__p&&__p();c=(a=b("prop-types")).shape({x:a.number.isRequired,y:a.number.isRequired});d=b("createReactClass_DEPRECATED")({displayName:"PhotoZoomCrop",mixins:[b("PhotoZoomCropMixin")],propTypes:{center:c,cropAspectRatio:c,cropSizeRatio:c,cropSize:c,imageSize:a.instanceOf(b("BasicVector")),messageText:a.string,overlay:a.element,previewSize:a.number,src:a.oneOfType([a.string,a.object]),warningText:a.string},getDefaultProps:function(){return{previewSize:32}},getInitialState:function(){__p&&__p();var a=this.props,c=a.center,d=a.cropAspectRatio,e=a.cropSizeRatio,f=a.cropSize;a=a.imageSize;this._dims=new(b("PhotoZoomCropDimensions"))(a);c&&this._dims.setCenter(c.x,c.y);f&&(this._dims.setSize(f.x,f.y),this._dims.setZoom(this._dims.getSize().x/a.x));if(e){c=e.x*a.x;this._dims.setZoom(this._dims.getSize().x/c)}d&&this._dims.setRatio(d.x,d.y);f=this._getDimensionsState();f.position=this._dims.getZoom();return f},render:function(){var a;return(a=b("React")).jsxs("div",{className:b("joinClasses")(this.props.className,"_4liw"),children:[a.jsx(b("PhotoZoomCropImage.react"),{className:"_1szc",dimensions:this._dims,enableDrag:this._dims.isCurrentlyDragable(),onMove:this._handleMove,overlay:this.props.overlay,src:this.props.src}),a.jsx(b("PhotoZoomCropImagePreview.react"),{className:"_1szd",dimensions:this._dims,overlay:this.props.overlay,size:{x:this.props.previewSize,y:this.props.previewSize},src:this.props.src}),a.jsx(b("PhotoZoomCropSlider.react"),{className:"_4lix",onZoom:this._handleZoom,position:this.state.position,zoom:this.state.zoom,zoomRange:this._dims.getZoomRange()}),this._getMessage()]})},__getZoom:function(){return this.state.zoom}});e.exports=d}),null);
__d("ZoomProfilePicDragger.react",["BasicVector","PhotoZoomCrop.react","React","prop-types"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.getDimsArea=function(){return c.getDimensions().getArea()},c.getImage=function(){return c.props.photoData.original},c.getDimensions=function(){return c.refs.zoomCrop.getDimensions()},c.resetDimensions=function(){return c.refs.zoomCrop.resetDimensions()},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.render=function(){var a=this.getImage(),c=this.props.photoData.facebox||{center:{x:.5,y:.5},size:{x:1,y:1}};return b("React").jsx(b("PhotoZoomCrop.react"),babelHelpers["extends"]({},this.props,{center:c.center,cropSizeRatio:c.size,imageSize:new(b("BasicVector"))(a.width,a.height),ref:"zoomCrop",src:a.uri}))};return c}(b("React").Component);a.propTypes={overlay:b("prop-types").element,photoData:b("prop-types").object.isRequired};e.exports=a}),null);
__d("PhotoCropperViewer.react",["cx","ix","ArbiterMixin","AsyncResponse","PhotoCropperSaver","PhotoCropperViewerStrings","ProfileMediaAlwaysPublicIcon.react","ProfilePicCropViewerLoading.react","ProfilePicCropViewerStrings","ProfilePicViewerFooterText.react","React","XUIButton.react","XUIDialog.react","XUIDialogFooter.react","XUIDialogTitle.react","XUIGrayText.react","ZoomProfilePicDragger.react","createReactClass_DEPRECATED","prop-types","tidyEvent"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=520;c=b("createReactClass_DEPRECATED")({displayName:"PhotoCropperViewer",mixins:[b("ArbiterMixin")],propTypes:{previewSize:(a=b("prop-types")).number,successCallback:a.func,errorCallback:a.func,cancelCallback:a.func},getDefaultProps:function(){return{previewSize:32}},getInitialState:function(){return{photoData:null,savingMode:!1}},render:function(){var a=this.state.photoData,c;a?c=b("PhotoCropperViewerStrings").REPOSITION_CURRENT_TITLE:!this.state.savingMode?c=b("PhotoCropperViewerStrings").LOADING:c=b("PhotoCropperViewerStrings").SAVING_TITLE;var d;(this.state.savingMode||!a)&&(d=b("React").jsx(b("ProfilePicCropViewerLoading.react"),{}));var e;a&&(e=b("React").jsx(b("ZoomProfilePicDragger.react"),{photoData:a,ref:"dragger"}));var f;this.state.savingMode?f=b("React").jsx(b("ProfilePicViewerFooterText.react"),{weight:"bold",children:b("PhotoCropperViewerStrings").SAVING_LABEL}):a?f=[b("React").jsx(b("ProfileMediaAlwaysPublicIcon.react"),{privacyMessage:b("ProfilePicCropViewerStrings").SCRAPBOOK_PIC_VISIBILITY,sourceImage:h("83912")}),b("React").jsx(b("XUIButton.react"),{label:b("PhotoCropperViewerStrings").BUTTON_CANCEL,onClick:this._handleCancel}),b("React").jsx(b("XUIButton.react"),{label:b("PhotoCropperViewerStrings").BUTTON_SAVE,onClick:this._handleSave,use:"confirm"})]:f=b("React").jsx(b("ProfilePicViewerFooterText.react"),{weight:"bold",children:b("PhotoCropperViewerStrings").LOADING_LABEL});return b("React").jsxs(b("XUIDialog.react"),{layerHideOnBlur:!1,modal:!0,shown:!0,width:i,children:[b("React").jsx(b("XUIDialogTitle.react"),{children:b("React").jsx(b("XUIGrayText.react"),{display:"block",shade:"medium",size:"header4",weight:"bold",children:c})}),b("React").jsxs("div",{className:"_2b8",children:[e,d]}),b("React").jsx(b("XUIDialogFooter.react"),{children:f})]})},componentWillUnmount:function(){this.props.unmountCallback&&this.props.unmountCallback()},getCropArea:function(){return this.refs.dragger.getDimsArea()},getPhotoSize:function(){return this.refs.dragger.getImage()},getCoordinates:function(a,b){return{x:a.x/b.width,y:a.y/b.height,width:a.width/b.width,height:a.height/b.height}},_handleCancel:function(){this.props.cancelCallback&&this.props.cancelCallback(),this.inform("close")},_handleSave:function(){this.setState({savingMode:!0});var a=this.getCoordinates(this.getCropArea(),this.getPhotoSize()),c=new(b("PhotoCropperSaver"))(this.state.photoData.id);b("tidyEvent")([c.subscribeOnce("success",this._savingSuccess),c.subscribeOnce("error",this._savingError)]);c.saveCroppedPhoto(a)},_savingSuccess:function(a,b){this.props.successCallback&&this.props.successCallback(b),this.inform("close")},_savingError:function(a,c){this.props.errorCallback&&this.props.errorCallback(),this.setState({savingMode:!1}),b("AsyncResponse").defaultErrorHandler(c)}});e.exports=c}),null);
__d("PhotoCropperViewerContainer",["PhotoCropperViewer.react","React","SpotlightViewerInit"],(function(a,b,c,d,e,f){__p&&__p();var g;a=function(){"use strict";function a(a){if(g)return g;g=b("SpotlightViewerInit").render(b("React").jsx(b("PhotoCropperViewer.react"),{cancelCallback:a.cancelCallback,errorCallback:a.errorCallback,successCallback:a.successCallback}),function(){g=null})}a.cropPhoto=function(b,c){g||new a(c),g.setState({photoData:b})};return a}();e.exports=a}),null);
__d("XFamilyProfilePhotoUploaderController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/family/edit/ajax/upload_profile_photo/",{photo_fbid:{type:"Int"}})}),null);
__d("ZoomProfilePicCropModes",[],(function(a,b,c,d,e,f){a=Object.freeze({CROP:"CROP",CROP_ONLY:"CROP_ONLY",FRAME:"FRAME",SET_THUMBNAIL:"SET_THUMBNAIL"});e.exports=a}),null);
__d("FamilyTaggingProfilePhotoUpload",["AsyncRequest","CSS","DOM","Event","FileInputUploader","PhotoCropperViewerContainer","ProfilePicCropViewerInit","ProfilePictureFlowLogging","XFamilyProfilePhotoUploaderController","ZoomProfilePicCropModes"],(function(a,b,c,d,e,f){__p&&__p();var g=null,h=116;a=function(){"use strict";__p&&__p();function a(a,c,d,e,f){g=this,this.$1=a,this.$2=d,this.$3=e,this.$4=f,this.$5=null,b("Event").listen(a.getInput(),"change",this.onFileChange.bind(this)),this.setMenuItemClickHandler(c)}var c=a.prototype;c.setPhotoFBIDCallback=function(a){this.$5=a};c.setMenuItemClickHandler=function(a){var b=this;a.forEachItem(function(a){a.getValue()==="upload_file"&&a.setOnClickHandler(function(){return b.$1.getInput().click()})})};c.onFileChange=function(){var a=this,c=b("XFamilyProfilePhotoUploaderController").getURIBuilder().getURI();c=new(b("FileInputUploader"))(this.$1.getInput()).setURI(c);c.subscribe("success",function(c,d){return a.openCropper(d.response.payload.photo_fbid,d.response.payload.photo_data,b("ProfilePictureFlowLogging").action.UPLOAD)});c.subscribe("failure",this.hideLoadingIcon.bind(this));this.showLoadingIcon();c.send()};c.onCropSuccess=function(a){this.updatePhotoPreview(a.payload.src),this.$5&&a.payload.photo_fbid&&this.$5(a.payload.photo_fbid)};c.openCropper=function(a,b,c){this.$4?this.openProfilePhotoCropper(a,c):this.openPhotoCropper(a,b)};c.openPhotoCropper=function(a,c){c.id=a,b("PhotoCropperViewerContainer").cropPhoto(c,{successCallback:this.onCropSuccess.bind(this),errorCallback:this.hideLoadingIcon.bind(this),cancelCallback:this.hideLoadingIcon.bind(this)})};c.openProfilePhotoCropper=function(a,c){b("ProfilePictureFlowLogging").setFlowType(b("ProfilePictureFlowLogging").flow.ZOOMCROP).setAction(c).log(b("ProfilePictureFlowLogging").step.CROP),b("ProfilePicCropViewerInit").loadID(a,this.$4,{cancelCallback:this.hideLoadingIcon.bind(this),cropMode:b("ZoomProfilePicCropModes").CROP_ONLY,errorCallback:this.hideLoadingIcon.bind(this),method:"upload",source:"family_member",successCallback:this.onCropSuccess.bind(this),warnOnCancel:!1})};c.showLoadingIcon=function(){b("CSS").show(this.$3)};c.hideLoadingIcon=function(){b("CSS").hide(this.$3)};c.updatePhotoPreview=function(a){var c=this,d=b("DOM").create("img",{width:h,height:h,src:a,onload:function(){b("DOM").setContent(c.$2,d),c.hideLoadingIcon()}})};a.onChooseExistingPhoto=function(a,c){var d=b("Event").listen(a,"click",function(){if(g){g.showLoadingIcon();var a=b("XFamilyProfilePhotoUploaderController").getURIBuilder().getURI();new(b("AsyncRequest"))().setURI(a).setData({photo_fbid:c}).setHandler(function(a){g.openCropper(a.payload.photo_fbid,a.payload.photo_data,b("ProfilePictureFlowLogging").action.FROM_PHOTOS)}).send()}d.remove()})};return a}();e.exports=a}),null);
__d("XCoverPicSaveController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/profile/cover/save/",{cover_instance:{type:"String",required:!0},photo_id:{type:"Int"},offset_x:{type:"Int"},offset_y:{type:"Int"},profile_id:{type:"Int"}})}),null);
__d("XFamilyTagCoverPicSaveController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/family/cover/save/",{profile_id:{type:"Int",required:!0},cover_instance:{type:"String",required:!0},photo_id:{type:"Int"},offset_x:{type:"Int"},offset_y:{type:"Int"}})}),null);
__d("ProfileCover",["csx","cx","ActorURI","AsyncRequest","Button","CSS","DOM","ServerRedirect","TimelineDrag","XCoverPicSaveController","XFamilyTagCoverPicSaveController","getOrCreateDOMID"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i={},j={};a=function(){"use strict";__p&&__p();function a(c,d,e,f,g){__p&&__p();g===void 0&&(g=!1),this.root=c,this.cover=d,this.profileID=f,this.editControls=e,this.newCoverPhoto=null,this.newCoverPhotoFBID=null,this.$1=b("getOrCreateDOMID")(d),i[this.$1]=this,this.editControls.subscribe("save",function(){__p&&__p();var c=this.getOffset();b("Button").setEnabled(this.editControls.getSaveButton(),!1);b("Button").setEnabled(this.editControls.getCancelButton(),!1);var d=b("DOM").find(this.newCoverPhoto,"img._xlg");d=a.isCoverImageVertical(d)?"offset_y":"offset_x";var e=b("XCoverPicSaveController").getURIBuilder();g&&(e=b("XFamilyTagCoverPicSaveController").getURIBuilder().setInt("profile_id",this.profileID));e=b("ActorURI").create(e.setString("cover_instance",this.$1).setInt("photo_id",this.newCoverPhotoFBID).setInt(d,c).setInt("profile_id",this.profileID).getURI(),this.profileID);new(b("AsyncRequest"))(e).setMethod("POST").setStatusElement(this.root).setHandler(function(){b("Button").setEnabled(this.editControls.getSaveButton(),!0);b("Button").setEnabled(this.editControls.getCancelButton(),!0);this.endPositioning();var a=b("CSS").matchesSelector(this.root,"._5e18");a&&(b("CSS").removeClass(this.root,"_5e18"),b("ServerRedirect").reloadPage())}.bind(this)).send()}.bind(this)),this.editControls.subscribe("cancel",function(){b("Button").setEnabled(this.editControls.getSaveButton(),!0),b("Button").setEnabled(this.editControls.getCancelButton(),!0),this.dragger&&(this.dragger.destroy(),this.dragger=null),b("DOM").remove(this.newCoverPhoto),this.newCoverPhoto=null,this.newCoverPhotoFBID=null,this.$2(!1)}.bind(this)),j[this.$1]&&(j[this.$1](this),j[this.$1]=null)}var c=a.prototype;c.getRoot=function(){return this.root};c.setPhotoToPosition=function(c,d){this.$2(!0);b("DOM").insertAfter(this.cover,c);var e=b("DOM").find(c,"img._xlg");this.newCoverPhoto=c;this.newCoverPhotoFBID=d;this.dragger=new(b("TimelineDrag"))(e,this.editControls.getInput(),{width:this.getWidth(),height:this.getHeight(),vertical:a.isCoverImageVertical(e),killClicks:!0,listenOn:c})};c.remove=function(){b("ServerRedirect").reloadPage()};c.error=function(a){a.show()};c.endPositioning=function(){this.dragger&&(this.dragger.destroy(),this.dragger=null,b("DOM").remove(this.cover),this.newCoverPhoto&&(this.cover=this.newCoverPhoto),this.newCoverPhoto=null,this.newCoverPhotoFBID=null,this.$2(!1))};c.getWidth=function(){return 851};c.getHeight=function(){return 315};c.getOffset=function(){return this.editControls.getInput().value};c.$2=function(a){a=a?b("CSS").addClass:b("CSS").removeClass;a(this.root,"_xlf")};a.addPhotoToPosition=function(b,c,d){a.getInstance(b).setPhotoToPosition(c,d)};a.finishPositioning=function(b){a.getInstance(b).endPositioning()};a.removeCover=function(b){a.getInstance(b).remove()};a.isCoverImageVertical=function(a){return!a.style.height};a.getInstance=function(a){return i[a]};a.waitForInstance=function(a,b){i[a]?b(i[a]):j[a]=b};a.resetInstance=function(a){i[a].reset()};a.uploadError=function(a,b){i[a].error(b)};return a}();e.exports=a}),null);
__d("ProfileCoverEditControls",["ArbiterMixin","Event","mixin"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d,e,f){__p&&__p();var g;g=a.call(this)||this;g.root=c;g.save=d;g.cancel=e;g.input=f;b("Event").listen(d,"click",function(){this.inform("save")}.bind(babelHelpers.assertThisInitialized(g)));b("Event").listen(e,"click",function(){this.inform("cancel")}.bind(babelHelpers.assertThisInitialized(g)));return g}var d=c.prototype;d.getSaveButton=function(){return this.save};d.getCancelButton=function(){return this.cancel};d.getInput=function(){return this.input};return c}(b("mixin")(b("ArbiterMixin")));e.exports=a}),null);